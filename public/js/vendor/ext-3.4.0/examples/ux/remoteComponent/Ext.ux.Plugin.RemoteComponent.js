Ext.namespace('Ext.ux');Ext.namespace('Ext.ux.Plugin');Ext.ux.Plugin.LiteRemoteComponent=function(config){var defaultType=config.xtype||'panel';var callback=function(res){this.container.add(Ext.ComponentMgr.create(Ext.decode(res.responseText),defaultType)).show();this.container.doLayout();};return{init:function(container){this.container=container;Ext.Ajax.request(Ext.apply(config,{success:callback,scope:this}));}}};Ext.ux.Plugin.RemoteComponent=function(config){var defaultType=config.xtype||'panel';Ext.applyIf(config,{purgeSubscribers:true});this.initialConfig=config;Ext.apply(this,config);this.addEvents({'beforeload':true,'beforecreate':true,'beforeadd':true,'beforecomponshow':true,'beforecontainshow':true,'success':true});Ext.ux.Plugin.RemoteComponent.superclass.constructor.call(this,config);if(config.breakOn){this.on(config.breakOn,function(){return false;});}
var renderComponent=function(JSON){if(this.fireEvent('beforeadd',JSON,this)){component=this.container.add(JSON);if(this.fireEvent('beforecomponshow',component,this)){return component;}}}.createDelegate(this);var callback=function(res){var JSON=Ext.decode(res.responseText);if(this.fireEvent('beforecreate',JSON,this)){var component=null;if(JSON instanceof Array){Ext.each(JSON,function(j,i){component=renderComponent(j).show();;});}else{component=renderComponent(JSON).show();}
if(this.fireEvent('beforecontainshow',component,this)){this.container.doLayout();this.fireEvent('success',component,this);}}
if(this.purgeSubscribers){this.purgeListeners();}}.createDelegate(this);this.load=function(){if(this.fireEvent('beforeload',config,this)){if(config.mask){var mask=new Ext.LoadMask(Ext.getDom(config.mask),Ext.apply({msg:'loading components...'},config.maskConfig||{}));mask.show();this.on('success',mask.hide,mask);}
Ext.Ajax.request(Ext.apply(config,{success:callback,scope:this}));}};this.init=function(container){container.on('beforedestroy',function(){this.purgeListeners();},this);this.container=container;if(config.loadOn){if(config.loadOn instanceof Array){Ext.each(config.loadOn,function(l,i,a){var evt=l.event||l.loadOn;var defer=function(){this.load();Ext.each(a,function(lo){(lo.scope||container).un(evt,defer,this);}.createDelegate(this));}.createDelegate(this);(l.scope||container).on(evt,defer,this);}.createDelegate(this));}else{(config.loadOn.scope||container).on((config.loadOn.event||config.loadOn),this.load,this,{single:true});}}else{this.load();}};};Ext.extend(Ext.ux.Plugin.RemoteComponent,Ext.util.Observable);